{
  "goals-clipboard": {
    "file": "goals-clipboard.md",
    "systems": [
      "goals clipboard overlay",
      "persistent goals per learner/facilitator",
      "goals_notes database column",
      "API endpoints (load/save)",
      "Mr. Mentor integration (system prompt)",
      "auto-load on learner switch",
      "600 character limit"
    ],
    "last_updated": "2025-12-31T12:30:00Z",
    "status": "canonical"
  },
  "lesson-notes": {
    "file": "lesson-notes.md",
    "systems": [
      "facilitator lesson notes",
      "lesson_notes JSONB column",
      "note UI in facilitator/lessons",
      "Mr. Mentor transcript integration",
      "note display per lesson",
      "learner-specific context"
    ],
    "last_updated": "2025-12-31T12:30:00Z",
    "status": "canonical"
  },
  "lesson-validation": {
    "file": "lesson-validation.md",
    "systems": [
      "automatic lesson quality validation",
      "two-call improvement flow",
      "lessonValidation.js",
      "critical issue checks",
      "toast notification progress",
      "Lesson Maker integration",
      "Mr. Mentor auto-validation"
    ],
    "last_updated": "2025-12-31T12:30:00Z",
    "status": "canonical"
  },
  "mr-mentor-memory": {
    "file": "mr-mentor-memory.md",
    "systems": [
      "conversation memory persistence",
      "automatic summarization (GPT-4o-mini)",
      "incremental summary updates",
      "conversation_updates table",
      "conversation_history_archive table",
      "fuzzy search (full-text)",
      "function calling tools (get/search memory)",
      "auto-archival (50 turns)",
      "dual context (facilitator/learner)"
    ],
    "last_updated": "2025-12-31T12:30:00Z",
    "status": "canonical"
  },
  "mr-mentor-sessions": {
    "file": "mr-mentor-sessions.md",
    "systems": [
      "single-device session enforcement",
      "session takeover with PIN",
      "mentor_sessions table",
      "cross-device conversation persistence",
      "session polling (8 seconds)",
      "SessionTakeoverDialog component",
      "automatic stale session cleanup"
    ],
    "last_updated": "2025-12-31T12:30:00Z",
    "status": "canonical"
  },
  "api-routes": {
    "file": "api-routes.md",
    "systems": [
      "/api/sonoma endpoint",
      "request format (instructions, innertext, session)",
      "response format (reply)",
      "logging controls (SONOMA_LOG_PREVIEW_MAX)",
      "stateless architecture",
      "instruction-driven behavior",
      "LLM provider configuration",
      "TTS endpoint",
      "visual aids endpoint",
      "content safety endpoint"
    ],
    "last_updated": "2025-12-31T00:00:00Z",
    "status": "canonical"
  },
  "v2-architecture": {
    "file": "v2-architecture.md",
    "systems": [
      "parallel implementation strategy",
      "feature flag system",
      "architectural boundaries",
      "event-driven communication",
      "AudioEngine component",
      "TeachingController component",
      "PhaseOrchestrator component",
      "snapshot compatibility layer",
      "migration sequence",
      "V1 vs V2 separation"
    ],
    "last_updated": "2025-12-30T00:00:00Z",
    "status": "active-development"
  },
  "mr-mentor-conversation-flows": {
    "file": "mr-mentor-conversation-flows.md",
    "systems": [
      "Mr. Mentor decision logic",
      "lesson generation vs recommendations",
      "function calling triggers",
      "escape hatch mechanisms",
      "recommendation intent detection",
      "generation intent detection",
      "parameter collection abandonment",
      "search_lessons prioritization",
      "generate_lesson restrictions",
      "conversational flow control"
    ],
    "last_updated": "2025-12-18T00:00:00Z",
    "status": "canonical"
  },
  "facilitator-help-system": {
    "file": "facilitator-help-system.md",
    "systems": [
      "facilitator help components",
      "InlineExplainer",
      "WorkflowGuide",
      "PageHeader",
      "contextual help",
      "dismissible tooltips",
      "localStorage persistence",
      "help content guidelines",
      "calendar tab explainers",
      "phase timers explanation",
      "learner configuration help",
      "lesson approval workflow",
      "weekly pattern explainer",
      "beta tester feedback"
    ],
    "last_updated": "2025-12-15T16:00:00Z",
    "status": "canonical"
  },
  "calendar-lesson-planning": {
    "file": "calendar-lesson-planning.md",
    "systems": [
      "lesson plan generation",
      "planned lessons persistence",
      "weekly pattern",
      "calendar automation",
      "lesson outline generation",
      "curriculum context",
      "medals API",
      "lesson history integration",
      "planned_lessons table",
      "database persistence",
      "savePlannedLessons",
      "loadPlannedLessons",
      "date-specific overwrite",
      "adaptive difficulty progression"
    ],
    "last_updated": "2025-12-15T02:30:00Z",
    "status": "canonical"
  },
  "tts-prefetching": {
    "file": "tts-prefetching.md",
    "systems": [
      "TTS prefetching",
      "ttsCache",
      "LRU cache",
      "background loading",
      "prefetch triggers",
      "cache clearing",
      "AbortController",
      "speakFrontendImpl",
      "question prefetch",
      "performance optimization",
      "cache hit instant audio"
    ],
    "last_updated": "2025-12-09T00:00:00Z",
    "status": "canonical"
  },
  "pin-protection": {
    "file": "pin-protection.md",
    "systems": [
      "PIN protection",
      "facilitator authentication",
      "session exit gating",
      "facilitator section tracking",
      "PIN preferences",
      "ensurePinAllowed",
      "setInFacilitatorSection",
      "FacilitatorSectionTracker",
      "navigation PIN checks",
      "double PIN prevention"
    ],
    "last_updated": "2025-12-03T04:00:00Z",
    "status": "canonical"
  },
  "snapshot-persistence": {
    "file": "snapshot-persistence.md",
    "systems": [
      "snapshot saves",
      "localStorage",
      "database persistence",
      "atomic gates",
      "checkpoint gates",
      "cross-device sync",
      "snapshot restore",
      "first-interaction gate",
      "complete lesson cleanup"
    ],
    "last_updated": "2025-12-02T03:15:00Z",
    "status": "canonical"
  },
  "timer-system": {
    "file": "timer-system.md",
    "systems": [
      "play timer",
      "work timer",
      "timer expiration",
      "30-second countdown overlay",
      "play time expired flow",
      "work phase completion tracking",
      "golden key timer bonus",
      "timer state persistence",
      "Go button override",
      "first-interaction timer gate",
      "opening action clearing"
    ],
    "last_updated": "2025-12-28T17:05:00Z",
    "status": "canonical"
  },
  "lesson-assessment-architecture": {
    "file": "lesson-assessment-architecture.md",
    "systems": [
      "lesson assessment generation",
      "question array persistence",
      "comprehension questions",
      "exercise questions",
      "worksheet generation",
      "test generation",
      "atomic restore",
      "localStorage assessment caching",
      "buildQAPool",
      "shuffle arrays",
      "refresh button"
    ],
    "last_updated": "2025-12-19T02:28:00Z",
    "status": "canonical"
  },
  "session-takeover": {
    "file": "session-takeover.md",
    "systems": [
      "session ownership",
      "device conflict detection",
      "PIN-validated takeover",
      "early conflict check",
      "snapshot restore sequencing",
      "timer state persistence",
      "cross-device session transfer",
      "learner lesson sessions"
    ],
    "last_updated": "2025-12-15T22:00:00Z",
    "status": "canonical"
  },
  "MentorInterceptor": {
    "file": "MentorInterceptor_Architecture.md",
    "systems": [
      "Mr. Mentor",
      "counselor flows",
      "generate flow",
      "schedule flow",
      "edit flow",
      "recall flow",
      "search flow"
    ],
    "last_updated": "2025-11-17T23:45:00Z",
    "status": "canonical"
  },
  "visual-aids": {
    "file": "visual-aids.md",
    "systems": [
      "visual aids generation",
      "DALL-E 3 integration",
      "prompt engineering no-text constraint",
      "image storage",
      "visual aids carousel",
      "lesson visual aids",
      "AI rewrite visual-aid purposes"
    ],
    "last_updated": "2025-11-25T19:45:00Z",
    "status": "canonical"
  },
  "ms-sonoma-teaching-system": {
    "file": "ms-sonoma-teaching-system.md",
    "systems": [
      "Ms. Sonoma",
      "teaching flow",
      "turn-based conversation",
      "phase transitions",
      "content safety",
      "prompt engineering",
      "leniency modes",
      "brand signal anchors",
      "normalization",
      "slot policy",
      "VERBATIM cues",
      "comprehension evaluation",
      "factual accuracy",
      "instruction hardening",
      "creative features lenient validation",
      "opening actions button visibility",
      "teaching gate hotkey gating"
    ],
    "last_updated": "2025-12-30T14:32:57Z",
    "status": "canonical"
  },
  "beta-program": {
    "file": "beta-program.md",
    "systems": [
      "Beta tier",
      "tutorial gating",
      "facilitator tutorial",
      "learner tutorial",
      "post-lesson survey",
      "password re-auth",
      "golden key unlock",
      "event instrumentation",
      "repeat tracking",
      "session duration",
      "facilitator notes",
      "transcript timestamps"
    ],
    "last_updated": "2025-11-25T00:00:00Z",
    "status": "canonical"
  },
  "auto-advance-phases": {
    "file": "auto-advance-phases.md",
    "systems": [
      "auto-advance phases",
      "begin button skip",
      "phase transition",
      "learner setting",
      "facilitator control",
      "break stalling prevention",
      "entrance automation"
    ],
    "last_updated": "2025-12-18T07:55:00Z",
    "status": "canonical"
  },
  "riddle-system": {
    "file": "riddle-system.md",
    "systems": [
      "riddles",
      "wordplay riddles",
      "localStorage rotation",
      "pickNextRiddle",
      "riddle transformation",
      "lateral thinking",
      "subject-specific riddles",
      "hardcoded riddle catalog",
      "riddle validation"
    ],
    "last_updated": "2025-12-03T00:00:00Z",
    "status": "canonical"
  },
  "mr-mentor-session-persistence": {
    "file": "mr-mentor-session-persistence.md",
    "systems": [
      "Mr. Mentor session management",
      "conversation persistence",
      "device takeover",
      "realtime subscriptions",
      "draft summaries",
      "turn limits",
      "zombie cleanup",
      "atomic gates",
      "stale data prevention",
      "mentor_sessions table",
      "conversation_drafts table",
      "conversation_updates table"
    ],
    "last_updated": "2025-12-09T00:00:00Z",
    "status": "canonical"
  },
  "auth-session-isolation": {
    "file": "auth-session-isolation.md",
    "systems": [
      "auth session isolation",
      "per-tab auth",
      "Supabase storageKey",
      "tab-local sessionStorage",
      "cross-tab auth leak prevention",
      "unique storage keys",
      "getTabStorageKey",
      "supabaseClient factory",
      "auth namespace isolation"
    ],
    "last_updated": "2025-12-09T20:00:00Z",
    "status": "canonical"
  },
  "content-safety": {
    "file": "content-safety.md",
    "systems": [
      "7-layer content safety defense",
      "profanity filter",
      "LLM moderation API",
      "system instructions hardening",
      "output validation",
      "feature-specific constraints",
      "rate limiting and monitoring",
      "template-based Ask/Poem/Story",
      "AI rewrite safety"
    ],
    "last_updated": "2025-12-31T13:00:00Z",
    "status": "canonical"
  },
  "lesson-editor": {
    "file": "lesson-editor.md",
    "systems": [
      "structured lesson editor",
      "form-based editing",
      "dynamic field management",
      "vocabulary term editor",
      "multiple choice editor",
      "true/false editor",
      "short answer editor",
      "fill-in-blank editor",
      "sample Q&A editor",
      "word problems editor",
      "validation and auto-cleanup"
    ],
    "last_updated": "2025-12-31T13:00:00Z",
    "status": "canonical"
  },
  "ai-rewrite-system": {
    "file": "ai-rewrite-system.md",
    "systems": [
      "AIRewriteButton component",
      "AI rewrite API",
      "visual-aid-description purpose",
      "generation-prompt purpose",
      "general purpose",
      "kid-friendly language rewriting",
      "DALL-E 3 prompt improvement",
      "Visual Aids Carousel integration"
    ],
    "last_updated": "2025-12-31T13:00:00Z",
    "status": "canonical"
  },
  "device-leases": {
    "file": "device-leases.md",
    "systems": [
      "concurrent device limiting",
      "device_leases table",
      "tier-based device caps",
      "device claim API",
      "device release API",
      "device status API",
      "lease expiration",
      "lease extension"
    ],
    "last_updated": "2025-12-31T13:00:00Z",
    "status": "canonical"
  },
  "lesson-quota": {
    "file": "lesson-quota.md",
    "systems": [
      "daily unique lesson starts",
      "lesson_unique_starts table",
      "timezone-aware day boundaries",
      "tier-based quotas",
      "quota check API",
      "quota enforcement API",
      "server-side validation"
    ],
    "last_updated": "2025-12-31T13:00:00Z",
    "status": "canonical"
  },
  "story-feature": {
    "file": "story-feature.md",
    "systems": [
      "continuous story narrative",
      "story setup phase (characters, setting, plot)",
      "story continuation across phases",
      "story ending in Test phase",
      "story transcript preservation",
      "story state management",
      "handleStoryStart handler",
      "handleStoryYourTurn handler"
    ],
    "last_updated": "2025-12-31T13:00:00Z",
    "status": "canonical"
  },
  "gating-system": {
    "file": "gating-system.md",
    "systems": [
      "universal gating system",
      "GatedOverlay component",
      "useAccessControl hook",
      "auth gates",
      "tier gates",
      "feature preview while gated",
      "authentication flow integration",
      "upgrade flow integration"
    ],
    "last_updated": "2025-12-31T13:00:00Z",
    "status": "canonical"
  }
}

{
  "facilitator-hub": {
    "file": "facilitator-hub.md",
    "systems": [
      "/facilitator",
      "hub-cards",
      "account",
      "billing-placement",
      "subscription-status"
    ],
    "last_updated": "2026-01-08T02:06:48Z",
    "status": "canonical"
  },
  "header-navigation": {
    "file": "header-navigation.md",
    "systems": [
      "HeaderBar",
      "top-nav-links",
      "facilitator-dropdown",
      "session-exit-pin-gate",
      "print-menu"
    ],
    "last_updated": "2026-01-10T16:50:44Z",
    "status": "canonical"
  },
  "homepage": {
    "file": "homepage.md",
    "systems": [
      "/",
      "home hero",
      "mssonoma.com",
      "external link",
      "learn-more copy"
    ],
    "last_updated": "2026-01-10T19:44:15Z",
    "status": "canonical"
  },
  "custom-subjects": {
    "file": "custom-subjects.md",
    "systems": [
      "custom_subjects",
      "/api/custom-subjects",
      "per-facilitator subjects",
      "subject dropdowns",
      "Mr. Mentor subjects"
    ],
    "last_updated": "2026-01-10T20:06:44Z",
    "status": "canonical"
  },
  "notifications-system": {
    "file": "notifications-system.md",
    "systems": [
      "facilitator notifications",
      "/facilitator/notifications",
      "facilitator_notifications",
      "facilitator_notification_prefs",
      "read_at",
      "notification settings",
      "no-localStorage"
    ],
    "last_updated": "2026-01-08T13:36:08Z",
    "status": "canonical"
  },
  "dev-server-and-chunks": {
    "file": "dev-server-and-chunks.md",
    "systems": [
      "next-dev",
      "chunk-404",
      "_next-static-chunks",
      "distDir",
      "next-config",
      "cache-clean",
      "restart-dev-3001"
    ],
    "last_updated": "2026-01-01T05:20:00Z",
    "status": "canonical"
  },
  "goals-clipboard": {
    "file": "goals-clipboard.md",
    "systems": [
      "goals-clipboard-overlay",
      "goals_notes",
      "/api/load-goals",
      "/api/save-goals",
      "Mr-Mentor-integration",
      "auto-load-learner-switch",
      "600-character-limit"
    ],
    "last_updated": "2026-01-06T05:15:00Z",
    "status": "canonical"
  },
  "lesson-notes": {
    "file": "lesson-notes.md",
    "systems": [
      "lesson_notes",
      "JSONB-column",
      "note-UI",
      "Mr-Mentor-transcript-integration",
      "learner-specific-context",
      "note-display-per-lesson"
    ],
    "last_updated": "2026-01-10T22:54:36Z",
    "status": "canonical"
  },
  "lesson-validation": {
    "file": "lesson-validation.md",
    "systems": [
      "automatic lesson quality validation",
      "two-call improvement flow",
      "lessonValidation.js",
      "critical issue checks",
      "toast notification progress",
      "Lesson Maker integration",
      "Mr. Mentor auto-validation"
    ],
    "last_updated": "2026-01-10T19:35:08Z",
    "status": "canonical"
  },
  "mr-mentor-memory": {
    "file": "mr-mentor-memory.md",
    "systems": [
      "conversation memory persistence",
      "automatic summarization (GPT-4o-mini)",
      "incremental summary updates",
      "conversation_updates table",
      "conversation_history_archive table",
      "fuzzy search (full-text)",
      "function calling tools (get/search memory)",
      "auto-archival (50 turns)"
    ],
    "last_updated": "2026-01-05T17:05:00Z",
    "status": "canonical"
  },
  "mr-mentor-sessions": {
    "file": "mr-mentor-sessions.md",
    "systems": [
      "single-device session enforcement",
      "session takeover with PIN",
      "mentor_sessions table",
      "cross-device conversation persistence",
      "session polling (8 seconds)",
      "SessionTakeoverDialog component",
      "automatic stale session cleanup"
    ],
    "last_updated": "2025-12-31T12:30:00Z",
    "status": "canonical"
  },
  "api-routes": {
    "file": "api-routes.md",
    "systems": [
      "/api/sonoma",
      "/api/counselor",
      "/api/lesson-schedule",
      "/api/lesson-assign",
      "instructions-field",
      "innertext-field",
      "session-field",
      "SONOMA_LOG_PREVIEW_MAX",
      "stateless-api",
      "instruction-driven-behavior",
      "LLM-provider-configuration",
      "/api/tts",
      "/api/visual-aids",
      "/api/content-safety"
    ],
    "last_updated": "2026-01-10T20:31:01Z",
    "status": "canonical"
  },
  "v2-architecture": {
    "file": "v2-architecture.md",
    "systems": [
      "parallel implementation strategy",
      "feature flag system",
      "architectural boundaries",
      "event-driven communication",
      "AudioEngine component",
      "TeachingController component",
      "GPT-based definitions generation",
      "GPT-based examples generation",
      "gate prompt two-phase flow",
      "PhaseOrchestrator component",
      "snapshot compatibility layer",
      "migration sequence",
      "V1 vs V2 separation",
      "video playback coordination",
      "user gesture unlock",
      "async-nextSentence",
      "ensureDefinitionsLoaded",
      "ensureExamplesLoaded",
      "loading-stages",
      "race-condition-fix",
      "comprehension-question-array",
      "learner-targets",
      "phase-question-counts",
      "footer-input",
      "TTS-spoken-questions",
      "generatedComprehension",
      "handleComprehensionGo",
      "handleComprehensionSubmit",
      "handleComprehensionSkip",
      "judging.js",
      "/api/judge-short-answer",
      "hint-hint-reveal",
      "worksheet-judging-parity",
      "test-judging-parity",
      "test-single-attempt",
      "no-early-answer-reveal",
      "exercise-inline-qa",
      "comprehension-to-exercise-transition",
      "begin-exercise",
      "worksheet-footer-input",
      "test-footer-input",
      "test-quick-answer-buttons",
      "formatQuestionForSpeech",
      "test-review",
      "golden-key-display",
      "work-timer-grid",
      "facilitator-override",
      "transcript-column-placement",
      "no-video-overlays",
      "caption-panel",
      "transcript-persistence",
      "timeline-jump",
      "test-skip-robustness",
      "no-premature-actions",
      "sequential-playback",
      "await-audio",
      "generated-lessons",
      "facilitator-lessons",
      "supabase-lesson-load"
    ],
      "last_updated": "2026-01-10T16:09:45Z",
    "status": "active-development"
  },
  "mr-mentor-conversation-flows": {
    "file": "mr-mentor-conversation-flows.md",
    "systems": [
      "Mr. Mentor decision logic",
      "search_lessons",
      "generate_lesson",
      "assign_lesson",
      "function-calling-triggers",
      "escape-hatch-mechanisms",
      "recommendation-intent",
      "generation-intent",
      "parameter-abandonment",
      "require_generation_confirmation",
      "conversational-flow-control"
    ],
    "last_updated": "2026-01-10T20:31:01Z",
    "status": "canonical"
  },
  "facilitator-help-system": {
    "file": "facilitator-help-system.md",
    "systems": [
      "InlineExplainer",
      "WorkflowGuide",
      "PageHeader",
      "help-button",
      "contextual-help",
      "dismissible-tooltips",
      "localStorage-help-state",
      "calendar-tab-explainers",
      "phase-timers-explanation",
      "learner-configuration-help",
      "lesson-approval-workflow",
      "weekly-pattern-explainer",
      "beta-tester-feedback"
    ],
    "last_updated": "2026-01-10T22:32:35Z",
    "status": "canonical"
  },
  "calendar-lesson-planning": {
    "file": "calendar-lesson-planning.md",
    "systems": [
      "planned_lessons",
      "savePlannedLessons",
      "loadPlannedLessons",
      "weekly-pattern",
      "calendar-automation",
      "lesson-outline-generation",
      "curriculum-context",
      "medals-API",
      "lesson-history-integration",
      "history-autofocus",
      "date-specific-overwrite",
      "adaptive-difficulty-progression",
      "manual-scheduling",
      "owned-lessons",
      "LessonPicker"
    ],
    "last_updated": "2026-01-12T22:05:00Z",
    "status": "canonical"
  },
  "tts-prefetching": {
    "file": "tts-prefetching.md",
    "systems": [
      "TTS prefetching",
      "ttsCache",
      "LRU cache",
      "background loading",
      "prefetch triggers",
      "cache clearing",
      "AbortController",
      "speakFrontendImpl",
      "question prefetch",
      "performance optimization",
      "cache hit instant audio"
    ],
    "last_updated": "2025-12-09T00:00:00Z",
    "status": "canonical"
  },
  "pin-protection": {
    "file": "pin-protection.md",
    "systems": [
      "PIN protection",
      "facilitator authentication",
      "session exit gating",
      "facilitator section tracking",
      "PIN preferences",
      "ensurePinAllowed",
      "setInFacilitatorSection",
      "FacilitatorSectionTracker",
      "navigation PIN checks",
      "double PIN prevention"
    ],
    "last_updated": "2026-01-12T23:57:07Z",
    "status": "canonical"
  },
  "snapshot-persistence": {
    "file": "snapshot-persistence.md",
    "systems": [
      "snapshot saves",
      "localStorage",
      "database persistence",
      "atomic gates",
      "checkpoint gates",
      "cross-device sync",
      "snapshot restore",
      "first-interaction gate",
      "complete lesson cleanup",
      "transcript persistence",
      "caption panel"
    ],
    "last_updated": "2026-01-12T18:24:58Z",
    "status": "canonical"
  },
  "timer-system": {
    "file": "timer-system.md",
    "systems": [
      "play timer",
      "work timer",
      "timer expiration",
      "30-second countdown overlay",
      "play time expired flow",
      "work phase completion tracking",
      "golden key timer bonus",
      "golden_keys_enabled",
      "play_*_enabled",
      "play portion toggles",
      "Golden Keys Off",
      "timer state persistence",
      "Go button override",
      "first-interaction timer gate",
      "opening action clearing",
      "TimerService",
      "playTimers Map",
      "startPlayTimer",
      "stopPlayTimer",
      "transitionToWork",
      "tickPlayTimers",
      "PlayTimeExpiredOverlay",
      "playTimerStart event",
      "playTimerTick event",
      "playTimerExpired event",
      "V2 parent-controlled overlay"
    ],
    "last_updated": "2026-01-12T15:00:19Z",
    "status": "canonical"
  },
  "learner-settings-bus": {
    "file": "learner-settings-bus.md",
    "systems": [
      "BroadcastChannel",
      "ms-learner-settings",
      "ms:learner-settings-patch",
      "per-learner settings",
      "no localStorage persistence",
      "immediate cross-tab updates",
      "golden_keys_enabled",
      "play_*_enabled",
      "loading flash",
      "toast gating",
      "LearnerEditOverlay",
      "optimistic toggle"
    ],
    "last_updated": "2026-01-08T03:44:22Z",
    "status": "canonical"
  },
  "lesson-assessment-architecture": {
    "file": "lesson-assessment-architecture.md",
    "systems": [
      "buildQAPool",
      "shuffle-arrays",
      "atomic-restore",
      "refresh-button",
      "comprehension-questions",
      "exercise-questions",
      "worksheet-questions",
      "test-questions",
      "localStorage-assessment-caching"
    ],
    "last_updated": "2025-12-31T16:00:00Z",
    "status": "canonical"
  },
  "session-takeover": {
    "file": "session-takeover.md",
    "systems": [
      "session ownership",
      "device conflict detection",
      "PIN-validated takeover",
      "early conflict check",
      "snapshot restore sequencing",
      "timer state persistence",
      "cross-device session transfer",
      "learner lesson sessions"
    ],
    "last_updated": "2025-12-15T22:00:00Z",
    "status": "canonical"
  },
  "MentorInterceptor": {
    "file": "MentorInterceptor_Architecture.md",
    "systems": [
      "Mr. Mentor frontend",
      "MentorInterceptor.js",
      "confidence-scoring",
      "fuzzy-matching",
      "parameter-extraction",
      "generate-flow",
      "assign-flow",
      "schedule-flow",
      "edit-flow",
      "recall-flow",
      "search-flow"
    ],
    "last_updated": "2026-01-10T22:54:36Z",
    "status": "canonical"
  },
  "visual-aids": {
    "file": "visual-aids.md",
    "systems": [
      "visual aids generation",
      "DALL-E 3 integration",
      "prompt engineering no-text constraint",
      "image storage",
      "visual aids carousel",
      "lesson visual aids",
      "AI rewrite visual-aid purposes",
      "session v2 integration"
    ],
    "last_updated": "2026-01-08T01:24:03Z",
    "status": "canonical"
  },
  "ms-sonoma-teaching-system": {
    "file": "ms-sonoma-teaching-system.md",
    "systems": [
      "Ms. Sonoma",
      "teaching flow",
      "turn-based conversation",
      "phase transitions",
      "content safety",
      "prompt engineering",
      "leniency modes",
      "brand signal anchors",
      "normalization",
      "slot policy",
      "VERBATIM cues",
      "comprehension evaluation",
      "factual accuracy",
      "instruction hardening",
      "creative features lenient validation",
      "opening actions button visibility",
      "teaching gate hotkey gating",
      "OpeningActionsController",
      "Ask Ms. Sonoma",
      "Riddle",
      "Joke",
      "Poem",
      "Story",
      "Fill-in-Fun",
      "Games overlay",
      "opening actions play time"
    ],
    "last_updated": "2026-01-08T16:32:27Z",
    "status": "canonical"
  },
  "platform-jumper": {
    "file": "platform-jumper.md",
    "systems": [
      "Platform Jumper",
      "game physics",
      "JUMP_STRENGTH",
      "TRAMPOLINE_BOUNCE",
      "gravity",
      "keyboard controls",
      "touch controls",
      "level-skip",
      "level-picker",
      "settings-gear"
    ],
    "last_updated": "2026-01-13T00:14:52Z",
    "status": "canonical"
  },
  "beta-program": {
    "file": "beta-program.md",
    "systems": [
      "Beta tier",
      "tutorial gating",
      "facilitator tutorial",
      "learner tutorial",
      "post-lesson survey",
      "password re-auth",
      "golden key unlock",
      "event instrumentation",
      "repeat tracking",
      "session duration",
      "facilitator notes",
      "transcript timestamps"
    ],
    "last_updated": "2025-11-25T00:00:00Z",
    "status": "canonical"
  },
  "auto-advance-phases": {
    "file": "auto-advance-phases.md",
    "systems": [
      "auto-advance phases",
      "begin button skip",
      "phase transition",
      "learner setting",
      "facilitator control",
      "break stalling prevention",
      "entrance automation"
    ],
    "last_updated": "2026-01-08T02:35:02Z",
    "status": "canonical"
  },
  "riddle-system": {
    "file": "riddle-system.md",
    "systems": [
      "riddles",
      "wordplay-riddles",
      "localStorage-rotation",
      "pickNextRiddle",
      "transformation-patterns",
      "quality-classification",
      "personification",
      "homonym-wordplay",
      "visual-metaphor",
      "lateral-thinking",
      "subject-specific-riddles",
      "hardcoded-riddle-catalog",
      "riddle-validation"
    ],
    "last_updated": "2025-12-31T17:00:00Z",
    "status": "canonical"
  },
  "mr-mentor-session-persistence": {
    "file": "mr-mentor-session-persistence.md",
    "systems": [
      "Mr. Mentor session management",
      "conversation persistence",
      "device takeover",
      "realtime subscriptions",
      "draft summaries",
      "turn limits",
      "zombie cleanup",
      "atomic gates",
      "stale data prevention",
      "mentor_sessions table",
      "conversation_drafts table",
      "conversation_updates table"
    ],
    "last_updated": "2025-12-09T00:00:00Z",
    "status": "canonical"
  },
  "auth-session-isolation": {
    "file": "auth-session-isolation.md",
    "systems": [
      "auth session isolation",
      "per-tab auth",
      "Supabase storageKey",
      "tab-local sessionStorage",
      "cross-tab auth leak prevention",
      "unique storage keys",
      "getTabStorageKey",
      "supabaseClient factory",
      "auth namespace isolation"
    ],
    "last_updated": "2025-12-09T20:00:00Z",
    "status": "canonical"
  },
  "content-safety": {
    "file": "content-safety.md",
    "systems": [
      "7-layer content safety defense",
      "profanity filter",
      "LLM moderation API",
      "system instructions hardening",
      "output validation",
      "feature-specific constraints",
      "rate limiting and monitoring",
      "template-based Ask/Poem/Story",
      "AI rewrite safety"
    ],
    "last_updated": "2025-12-31T13:00:00Z",
    "status": "canonical"
  },
  "lesson-editor": {
    "file": "lesson-editor.md",
    "systems": [
      "structured-lesson-editor",
      "form-based-editing",
      "vocabulary-term-editor",
      "multiple-choice-editor",
      "true-false-editor",
      "short-answer-editor",
      "fill-in-blank-editor",
      "new-lesson",
      "/api/facilitator/lessons/create",
      "sample-QA-editor",
      "word-problems-editor",
      "validation-auto-cleanup",
      "dynamic-field-management"
    ],
    "last_updated": "2026-01-10T19:27:04Z",
    "status": "canonical"
  },
  "lesson-library-downloads": {
    "file": "lesson-library-downloads.md",
    "systems": [
      "/facilitator/lessons",
      "lesson library",
      "owned lessons",
      "downloadable lessons",
      "server-side download",
      "supabase storage copy",
      "no device storage",
      "new-lesson",
      "unlock gating"
    ],
    "last_updated": "2026-01-10T19:35:08Z",
    "status": "canonical"
  },
  "ai-rewrite-system": {
    "file": "ai-rewrite-system.md",
    "systems": [
      "AIRewriteButton",
      "/api/rewrite",
      "visual-aid-description-purpose",
      "generation-prompt-purpose",
      "general-purpose",
      "kid-friendly-rewriting",
      "DALL-E-3-prompt-improvement",
      "Visual-Aids-Carousel-integration"
    ],
    "last_updated": "2025-12-31T16:00:00Z",
    "status": "canonical"
  },
  "device-leases": {
    "file": "device-leases.md",
    "systems": [
      "device_leases",
      "tier-based-device-caps",
      "/api/device-claim",
      "/api/device-release",
      "/api/device-status",
      "lease-expiration",
      "lease-extension",
      "concurrent-device-limiting"
    ],
    "last_updated": "2025-12-31T16:00:00Z",
    "status": "canonical"
  },
  "lesson-quota": {
    "file": "lesson-quota.md",
    "systems": [
      "daily unique lesson starts",
      "lesson_unique_starts table",
      "timezone-aware day boundaries",
      "tier-based quotas",
      "quota check API",
      "quota enforcement API",
      "server-side validation"
    ],
    "last_updated": "2026-01-10T19:42:04Z",
    "status": "canonical"
  },
  "story-feature": {
    "file": "story-feature.md",
    "systems": [
      "continuous story narrative",
      "story setup phase (characters, setting, plot)",
      "story continuation across phases",
      "story ending in Test phase",
      "story transcript preservation",
      "story state management",
      "handleStoryStart handler",
      "handleStoryYourTurn handler"
    ],
    "last_updated": "2025-12-31T13:00:00Z",
    "status": "canonical"
  },
  "gating-system": {
    "file": "gating-system.md",
    "systems": [
      "GatedOverlay",
      "useAccessControl",
      "auth-gates",
      "tier-gates",
      "feature-preview-while-gated",
      "authentication-flow-integration",
      "upgrade-flow-integration",
      "universal-gating"
    ],
    "last_updated": "2025-12-31T16:00:00Z",
    "status": "canonical"
  }
}
